<%- include('partials/header.ejs') %>
<div class="row min-vw-100 p-0 m-0 h-100 flex-grow-1" >
    <nav class="col col-2 nav flex-grow-1 p-0 text-break bg-light">
        <div class="w-100 h-fit-content">
            <div class="nav-link text-secondary px-3 py-2 d-flex justify-content-between align-items-center"><span>Vos agendas </span>
                <button onclick="window.location.href='/modifierAgendas'" class="btn btn-sm btn-secondary text-white">Modifier</button>
            </div>
            <div class="w-100 d-flex h-fit-content p-3">
                <button class="btn btn-outline-secondary w-100" id="ouvreDialogCreationAgenda" onclick="openDialog()">
                    <span class="bi bi-plus-lg" role="img"></span>
                </button>
            </div>
            <ul class="list-group px-3 py-2">
                <li id="selectAll" class="list-group-item list-group-item-light user-select-none" onclick="toggleAll('agendaList', 'selectAll')">Tout s√©lectionner</li>
            </ul>
            <ul id="agendaList" class="list-group px-3 listAgenda align-self-end">
                <% for (const agenda_id of Object.keys(locals.agendas)) { %>
                    <% const active_text = locals.agendas[agenda_id].displayed ? "active" : ""; %>
                    <li class="list-group-item list-group-item-light user-select-none <%= active_text %>" id="agenda_<%= agenda_id %>" onclick='toggleAgenda("agenda_<%= agenda_id %>")'><%= locals.agendas[agenda_id].nom %></li>
                <% } %>
            </ul>

        </div>

    </nav>
    <div class="col col-10 p-3 d-flex flex-column">
        <div id="calendar"></div>
    </div>
</div>
<script>
    /**
     * Fonction qui change la taille de la liste des agendas en fonction de la taille de la fenetre
     */
    function adjustListHeight() {
        const listAgenda = document.querySelector('.listAgenda');
        let fact = window.innerHeight > 700 ? 0.75 : 0.5;
        listAgenda.style.maxHeight = `${window.innerHeight * fact}px`;
    }

    window.addEventListener('load', adjustListHeight);
    window.addEventListener('resize', adjustListHeight);
</script>
<%- include('viewDialogCreationAgenda.ejs') %>
<script src="/js/dialogCreationAgenda.js"></script>
<script type='importmap'>
    {
      "imports": {
        "@fullcalendar/core": "https://cdn.skypack.dev/@fullcalendar/core@6.1.15",
        "@fullcalendar/daygrid": "https://cdn.skypack.dev/@fullcalendar/daygrid@6.1.15",
        "@fullcalendar/timegrid": "https://cdn.skypack.dev/@fullcalendar/timegrid@6.1.15",
        "@fullcalendar/list": "https://cdn.skypack.dev/@fullcalendar/list@6.1.15",
        "@fullcalendar/bootstrap5": "https://cdn.skypack.dev/@fullcalendar/bootstrap5@6.1.15"
      }
    }
</script>
<script type="module" src="./js/calendar_controleur.js"></script>
<script src="./js/script_rendezvous.js"></script>